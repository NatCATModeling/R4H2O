## Cae Study 1: Water Quality Regulations
## Load data
turbidity <- read.csv("session2/turbidity_laanecoorie.csv")

## Inspect data
turbidity
dim(turbidity)

head(turbidity)
tail(turbidity)
View(turbidity)

str(turbidity)

names(turbidity)

turbidity$Result
turbidity$Date_Sampled

## Convert data
turbidity$Date_Sampled <- as.Date(turbidity$Date_Sampled)

## Explore data
table(turbidity$Zone)
max(turbidity$Result)
range(turbidity$Result)
summary(turbidity$Result)
unique(turbidity$Zone)

# Add data
turbidity$Comply <- turbidity$Result <= 5
turbidity$Comply
sum(turbidity$Comply) / nrow(turbidity)

# Subset data
turbidity[1:10, 4:5]
names(turbidity)[4:5]
turbidity[1:10, c("Zone", "Result")]

turbidity$Zone == "Laanecoorie"

laanecoorie <- turbidity[turbidity$Zone == "Laanecoorie", ]
laanecoorie <- subset(turbidity, Zone == "Laanecoorie")
summary(laanecoorie$Result)

# Anlyse data
quantile(turbidity$Result, probs = 0.95, type = 5)

sapply(1:9, function(m) quantile(turbidity$Result, 0.95, type = m))

tapply(turbidity$Result, turbidity$Zone,
       function(x) sapply(1:9, function(m) quantile(x, 0.95, type = m)))

tapply(turbidity, turbidity$Zone, mean)

## Visualise data
boxplot(turbidity$Result)
hist(turbidity$Result)

boxplot(turbidity$Result ~ turbidity$Zone)
